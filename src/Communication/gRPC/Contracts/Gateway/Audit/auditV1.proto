syntax = "proto3";

import "google/protobuf/empty.proto";
import "google/protobuf/timestamp.proto";

package ayborg.gateway.audit.v1;

service Audit {
    rpc AddEntry (AuditEntry) returns (google.protobuf.Empty);
    rpc GetEntries (GetAuditEntriesRequest) returns (stream AuditEntry);
    rpc GetReportMetas (GetAuditReportMetasRequest) returns (stream AuditReportMeta);
}

message AuditEntry {
    string service_type = 1;
    string service_unique_name = 2;
    google.protobuf.Timestamp timestamp = 3;
    int32 type = 4;
    string json = 5;
}

message AuditReportMeta {
    string service_type = 1;
    string service_unique_name = 2;
    google.protobuf.Timestamp timestamp = 3;
}

message GetAuditEntriesRequest {
    string service_type = 1;
    string service_unique_name = 2;
    google.protobuf.Timestamp from = 3;
    google.protobuf.Timestamp to = 4;
}

message GetAuditReportMetasRequest {
    string service_type = 1;
    string service_unique_name = 2;
    google.protobuf.Timestamp from = 3;
    google.protobuf.Timestamp to = 4;
}
